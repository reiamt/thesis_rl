
[2023-05-21 14:26:38,321, ema.py:67] EMA smoothing ENABLED: 0.99
[2023-05-21 14:26:41,168, data_pipeline.py:49] Imported 101_20200102_merge.csv.xz from a csv in 2 seconds
[2023-05-21 14:26:41,389, ema.py:93] Applying EMA to data...
[2023-05-21 14:26:43,596, data_pipeline.py:49] Imported /XBTUSD_2020-01-03.csv.xz from a csv in 1 seconds
[2023-05-21 14:26:43,774, ema.py:93] Applying EMA to data...
[2023-05-21 14:26:43,992, data_pipeline.py:228] Adding order imbalances...
[2023-05-21 14:26:44,011, ema.py:127] Reset EMA data.
[2023-05-21 14:26:44,012, ema.py:93] Applying EMA to data...
Resetting environment #1 on episode #0.
market-maker-v0 XBTUSD #1 instantiated
observation_space: (100, 174) reward_type = TRADE_COMPLETION max_steps = 86345
Using cpu device
Resetting environment #1 on episode #0.
Logging to ./runs/vbgsm6kn/DQN_1
[2023-05-21 14:26:44,228, ema.py:67] EMA smoothing ENABLED: 0.99
[2023-05-21 14:26:44,228, ema.py:67] EMA smoothing ENABLED: 0.99
[2023-05-21 14:26:44,228, ema.py:67] EMA smoothing ENABLED: 0.99
[2023-05-21 14:26:44,229, ema.py:67] EMA smoothing ENABLED: 0.99
Traceback (most recent call last):
  File "agent/sb3.py", line 78, in <module>
    model.learn(
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/stable_baselines3/dqn/dqn.py", line 269, in learn
    return super().learn(
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 311, in learn
    rollout = self.collect_rollouts(
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 551, in collect_rollouts
    if callback.on_step() is False:
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/stable_baselines3/common/callbacks.py", line 104, in on_step
    return self._on_step()
  File "agent/sb3.py", line 74, in _on_step
    rewards = self.locals['info_dict']['trade_completion']
KeyError: 'info_dict'