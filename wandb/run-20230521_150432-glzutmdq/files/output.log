
[2023-05-21 15:04:35,293, ema.py:67] EMA smoothing ENABLED: 0.99
[2023-05-21 15:04:38,128, data_pipeline.py:49] Imported 101_20200102_merge.csv.xz from a csv in 2 seconds
[2023-05-21 15:04:38,353, ema.py:93] Applying EMA to data...
[2023-05-21 15:04:40,549, data_pipeline.py:49] Imported /XBTUSD_2020-01-03.csv.xz from a csv in 1 seconds
[2023-05-21 15:04:40,725, ema.py:93] Applying EMA to data...
[2023-05-21 15:04:40,947, data_pipeline.py:228] Adding order imbalances...
[2023-05-21 15:04:40,967, ema.py:127] Reset EMA data.
[2023-05-21 15:04:40,967, ema.py:93] Applying EMA to data...
Resetting environment #1 on episode #0.
market-maker-v0 XBTUSD #1 instantiated
observation_space: (100, 174) reward_type = TRADE_COMPLETION max_steps = 86345
Using cpu device
Resetting environment #1 on episode #0.
Logging to ./runs/glzutmdq/DQN_1
[2023-05-21 15:04:41,181, ema.py:67] EMA smoothing ENABLED: 0.99
[2023-05-21 15:04:41,182, ema.py:67] EMA smoothing ENABLED: 0.99
[2023-05-21 15:04:41,182, ema.py:67] EMA smoothing ENABLED: 0.99
[2023-05-21 15:04:41,182, ema.py:67] EMA smoothing ENABLED: 0.99
Traceback (most recent call last):
  File "agent/sb3.py", line 84, in <module>
    model.learn(
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/stable_baselines3/dqn/dqn.py", line 269, in learn
    return super().learn(
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 311, in learn
    rollout = self.collect_rollouts(
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 551, in collect_rollouts
    if callback.on_step() is False:
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/stable_baselines3/common/callbacks.py", line 104, in on_step
    return self._on_step()
  File "agent/sb3.py", line 79, in _on_step
    self.episode_stats_reward += self.training_env.get_attr("episode_stats.reward")[0]
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 115, in get_attr
    return [getattr(env_i, attr_name) for env_i in target_envs]
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 115, in <listcomp>
    return [getattr(env_i, attr_name) for env_i in target_envs]
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/gym/core.py", line 238, in __getattr__
    return getattr(self.env, name)
  File "/Users/tam/miniconda3/envs/thesis/lib/python3.8/site-packages/gym/core.py", line 238, in __getattr__
    return getattr(self.env, name)
AttributeError: 'MarketMaker' object has no attribute 'episode_stats.reward'